\section{Spectral theorem and Borel functional calculus}

\subsection{Spectral theorem}

Recall the spectral theorem for compact operators.

\begin{theorem}[Spectral theorem for compact operators]
  If $T \in \mathcal{K} (\mathcal{H})$ is self-adjoint, then $T$ 
  has only a countable number of distinct eigenvalues, where each nonzero eigenvalue has finite multiplicity.
  If $\{\lambda_1, \lambda_2, \dots\}$ are the distinct eigenvalues of $T$,
  and $P_n$ is the projection of $\mathcal{H}$ onto $\ker (T - \lambda_n)$, 
  then $P_n P_m = 0$ for $n \neq m$ and 
  $$T = \sum_{n = 1} ^\infty \lambda_n P_n.$$
\end{theorem}

Our first goal is to generalize this result to non-compact self-adjoint operators.

\begin{theorem}[Vigier]
  Let $(u_\lambda)$ be a net of increasing (decreasing) and bounded above (below) self-adjoint operators on $\mathcal{H}$.
  Then $(u_\lambda)$ converges.
\end{theorem}

\begin{myproof}
  We prove the statement for an increasing net that is bounded above. We can assume $(u_\lambda)$ has a lower bound $m$ by considering a truncated net. 
  Without loss of generality, we assume $u_\lambda$ is positive (otherwise, consider $u_\lambda - m$).
  There exists $M \geq 0$ such that $\|u_\lambda\| \leq M$ for all indices $\lambda$. So the net $\langle u_\lambda x, x\rangle$
  is real, increasing, and bounded above by $M \|x\|^2$. Using the polarization identity, 
  $$\langle u_\lambda x, x\rangle = \frac{1}{4} \sum_{k = 0} ^3 i^k \langle u_\lambda (x + i^k y), x + i^k y\rangle,$$
  we see that $\langle u_\lambda x, y\rangle$ is a convergent net for all $x, y \in \mathcal{H}$.
  Letting $\sigma(x, y)$ denote its limit, we can easily check that $\sigma$ is a bounded sesquilinear form ($|\sigma(x, y)| \leq M\|x\| \|y\|$).
  By Riesz's representation theorem, there exists an operator $u \in \mathcal{B} (\mathcal{H})$ such that $\langle ux, y\rangle = \sigma(x, y)$.
  Then $u$ is self-adjoint, $\|u\| \leq M$, and $u_\lambda \leq u$. Note that 
  \begin{align*}
    \| (u - u_\lambda)x\|^2 &\leq \| (u - u_\lambda)^{\frac{1}{2}} (u - u_\lambda)^{\frac{1}{2}} x \|^2\\
    &\leq \| (u - u_\lambda) \| \| (u - u_\lambda)^{\frac{1}{2}} x\|^2\\
    &\leq 2M \langle (u - u_\lambda)x, x\rangle \to 0,
  \end{align*}
  so $u_\lambda$ converges strongly to $u$.
\end{myproof}

\begin{remark}
  If $(p_\lambda)$ is a net of projections converging strongly to some operator $u$, then $u$ is also a projection.
  Clearly, $u$ is self-adjoint, and 
  \begin{align*}
    \langle ux, y \rangle &= \lim_{\lambda} \langle p_\lambda x, y\rangle = \lim_{\lambda} \langle p_\lambda x, p_\lambda y \rangle\\
    &= \langle ux, uy\rangle = \langle u^2 x, y\rangle,
  \end{align*}
  therefore, $u^2 = u$.
\end{remark}

\begin{corollary}
  If $(p_n)_{n \in \mathbb{N}}$ is a sequence of pairwise orthogonal projections in $\bh$,
  then $\left(\sum_{n = 1} ^N p_n\right)$ SOT-converges as $N \to \infty$ (we denote the limit by $\sum_{n = 1} ^\infty p_n$). 
\end{corollary}

\begin{definition}
  Let $X$ be a set, $\Omega$ a $\sigma$-algebra in $X$, and $\mathcal{H}$ a Hilbert space.
  A \emph{projection-valued measure} (PVM) for $(X, \Omega, \mathcal{H})$ is a map 
  $E: \Omega \to \bh$ such that 
  \begin{enumerate}
    \item $E(S)$ is a projection for all $S \in \Omega$;
    \item $E(\emptyset) = 0$ and $E(X) = 1$;
    \item $E(S \cap T) = E(S) E(T)$ for all $S, T \in \Omega$;
    \item If $(S_n)_{n \in \mathbb{N}} \subseteq \Omega$ is a sequence of pairwise disjoint sets, then 
    $$E \left(\bigcup_{n = 1} ^\infty S_n\right) = \sum_{n = 1} ^\infty E(S_n).$$
  \end{enumerate}
\end{definition}

\begin{remark}
  The projections $E(S)$ commute with each other, which follows directly from the third point of the definition.
\end{remark}

\begin{example}
  Let $(X, \Omega, \mu)$ be a $\sigma$-finite measure space.
  Let $\mathcal{H} = L^2 (X, \mu)$, and for $S \in \Omega$, define $E(S) := \chi_S \in \mathcal{B} (L^2 (X, \mu))$. 
  Then $E: \Omega \to \mathcal{B}(L^2 (X, \mu))$ is a PVM.
\end{example}

\begin{lemma}  
  Let $E$ be a PVM for $(X, \Omega, \mathcal{H})$. Then, for all $\alpha, \beta \in \mathcal{H}$, the mapping  
  $$  E_{\alpha, \beta} : \Omega \to \C, \quad S \mapsto \langle E(S) \alpha, \beta \rangle$$
  is a complex measure on $\Omega$ with total variation $\leq \|\alpha\| \|\beta\|$.  
\end{lemma}  

\begin{myproof}  
  Let $\alpha, \beta \in \mathcal{H}$. Then $E_{\alpha, \beta}$ is $\sigma$-additive  
  (i.e., countably additive for disjoint sets) since $E$ is $\sigma$-additive by (4).  
  The total variation of a complex measure is given by  
  $$ \| E_{\alpha, \beta} \| := \sup \left\{\sum_{S \in \pi} |E_{\alpha, \beta} (S)|\right\},  $$
  where the sum is taken over all partitions of $X$ into finitely many measurable sets.  
  Let $\pi = \{S_1, \dots, S_n\}$ be a partition of $X$ with $S_j \in \Omega$.  
  For each $j$, pick $\alpha_j \in \C$ such that $|\alpha_j| = 1$ and  
  $$\alpha_j \cdot E_{\alpha, \beta} (S_j) = \alpha_j \langle E(S_j)\alpha, \beta\rangle = |\langle E(S_j) \alpha, \beta\rangle| = |E_{\alpha, \beta} (S_j)|.$$
  Then,  
  $$\sum_{j = 1} ^n |E_{\alpha, \beta} (S_j)| = |\langle \sum \alpha_j E(S_j) \alpha, \beta\rangle| \leq \| \sum \alpha_j E(S_j) \alpha\| \cdot \|\beta\|.$$
  For $i \neq j$, we have  
  $$ E(S_i) E(S_j) = E(S_i \cap S_j) = E(\emptyset) = 0, $$
  so $E(S_i)$ and $E(S_j)$ are pairwise orthogonal. Finally, applying the Pythagorean theorem, we get  
  \begin{align*}  
    \| \sum_{j = 1} ^n \alpha_j E(S_j) \alpha\|^2 &= \sum_{j = 1} ^n \| E(S_j) \alpha\|^2\\  
    &= \| \sum_{j = 1} ^n E(S_j) \alpha\|^2\\  
    &= \| E\left(\bigcup_{j = 1} ^n S_j\right) \alpha\|^2\\  
    &= \| E(X) \alpha\|^2 = \|\alpha \|^2. \qedhere  
  \end{align*}  
\end{myproof}  

\begin{remark}  
  Let $E$ be a PVM for $(X, \Omega, \mathcal{H})$, and let $\alpha \in \mathcal{H}$ and $S \in \Omega$.  
  Then,  
  \begin{align*}  
    E_{\alpha, \alpha} (S) &= \langle E(S) \alpha, \alpha\rangle\\  
    &= \langle E(S)^2 \alpha, \alpha\rangle\\  
    &= \langle E(S) \alpha, E(S) \alpha\rangle \geq 0,  
  \end{align*}  
  so $E_{\alpha, \alpha}$ is a positive measure on $X$.  
  Furthermore, if $\|\alpha\| = 1$, then $E_{\alpha, \alpha}$ is a probability measure.  
\end{remark}  

Define  
$$(\alpha, \beta) \mapsto \int_X 1 \, dE_{\alpha, \beta}.$$  
Since  
$$E_{\alpha + \lambda \alpha', \beta} = E_{\alpha, \beta} + \lambda E_{\alpha', \beta}$$
and  
$$E_{\alpha, \beta + \lambda \beta'} = E_{\alpha, \beta} + \overline{\lambda} E_{\alpha, \beta'},$$
the above defines a sesquilinear form on $\mathcal{H}$. In particular, it is bounded:  
$$\left\| \int_X dE_{\alpha, \beta} \right\| \leq \| E_{\alpha, \beta}\| \leq \|\alpha\| \|\beta\|.$$  
Suppose $f: X \to \C$ is a bounded $\Omega$-measurable function. Then  
$$(\alpha, \beta) \mapsto \int_X f \, dE_{\alpha, \beta}$$
defines a bounded sesquilinear form:  
$$\left\| \int_X f\, dE_{\alpha, \beta} \right\| \leq \|f\|_{\infty} \| E_{\alpha, \beta}\| \leq \|f\|_{\infty} \|\alpha\| \|\beta\|.$$  
So there exists an $x \in \bh$ such that $\| x\| \leq \| f\|_\infty$ and  
$$\langle x \alpha, \beta \rangle = \int_X f\, dE_{\alpha, \beta}.$$  
If $f = \chi_S$ for $S \in \Omega$, then $x = E(S)$, i.e.,  
$$\int_X \chi_S\, dE_{\alpha, \beta} = E_{\alpha, \beta} (S) = \langle E(S) \alpha, \beta \rangle.$$

\begin{definition}  
  Let $E$ be a PVM for $(X, \Omega, \mathcal{H})$, and let $f: X \to \C$ be a bounded $\Omega$-measurable function.  
  We call $x \in \bh$ the \emph{integral of $f$ with respect to $E$} if  
  $$\langle x\alpha, \beta \rangle = \int_X f\, dE_{\alpha, \beta},\quad \forall \alpha, \beta \in \mathcal{H}.$$  
  We denote it by  
  $$  x := \int_X f\, dE.$$  
\end{definition}  

\begin{remark}  
  Define $B(X, \Omega)$ as the set of all bounded $\Omega$-measurable complex functions on $X$, endowed with the supremum norm.  
  If $X$ is a topological space and $\Omega = \mathcal{B}_X$ is the Borel $\sigma$-algebra on $X$,  
  then $B(X) = B(X, \mathcal{B}_X)$.  
\end{remark}  

\begin{proposition}\label{prop:6.1}
  Let $E$ be a PVM for $(X, \Omega, \mathcal{H})$. Then, the mapping  
  $$\Phi: B(X, \Omega) \to \bh,\quad f \mapsto \int_X f\, dE$$
  is a $*$-homomorphism and contractive. Furthermore:  
  \begin{enumerate}  
    \item If $(f_n)_n \subseteq B (X, \Omega)$ is an increasing sequence of nonnegative functions  
    and $f = \sup_n f_n \in B (X, \Omega)$, then $\int_X f_n dE \to \int_X f\, dE$ in SOT.  
    \item If $X$ is compact and $T_2$, then $\Phi (B (X)) \subseteq \Phi (C(X))''$.  
  \end{enumerate}  
\end{proposition}  

\begin{myproof}
  We already saw that $\|\Phi (f)\| \leq \| f\|_{\infty}$; hence, $\Phi$ is contractive.
  It is also clear that $\Phi$ is linear and that $\Phi (f)^* = \Phi (\overline{f})$.
  Next, we prove multiplicativity: $\Phi (\chi_S) = E(S)$ for $S \in \Omega$.
  Then, 
  $$\Phi (\chi_S) \cdot \Phi (\chi_T) = E(S) \cdot E(T) = E(S \cap T) = \Phi (\chi_{S \cap T}) = \Phi (\chi_S \cdot \chi_T).$$
  Since $\Phi$ is linear, it is also multiplicative on simple functions (which are finite linear combinations of characteristic functions). 
  Since each $f \in B (X, \Omega)$ is a uniform limit of a uniformly bounded sequence of simple functions,
  we deduce that $\Phi (fg) = \Phi (f) \Phi (g)$ for all $f, g \in B (X, \Omega)$.
  \begin{enumerate}
    \item Let $f, f_n$ be as in the statement. Since $\Phi$ is a $*$-homomorphism,
    $(\Phi(f_n))_n$ is an increasing sequence of positive operators, and $\sup_n \| \Phi (f_n)\| \leq \sup_{n} \|f_n\|_{\infty} = \|f\|$.
    By Vigier, there exists $x \in \bh$ such that $\Phi(f_n) \xrightarrow{\mathrm{SOT}} x$.
    This $x$ is a natural candidate for $\Phi(f)$. Indeed, for $\alpha, \beta \in \mathcal{H}$, we have 
    \begin{align*}
      \langle \Phi(f) \alpha, \beta\rangle &= \int_X f\, dE_{\alpha, \beta}\\
      &= \lim_{n \to \infty} \int_X f_n\, dE_{\alpha, \beta}\\
      &= \lim_{n \to \infty} \langle \Phi(f_n) \alpha, \beta\rangle,
    \end{align*}
    so $\Phi(f_n) \xrightarrow{\mathrm{WOT}} \Phi(f)$, and therefore $\Phi(f) = x$.
    \item Let $X$ be compact Hausdorff and $a \in \Phi(C(X))'$. Take $\alpha, \beta \in \mathcal{H}$.
    Then, for all $f \in C(X)$, we have 
    \begin{align*}
      0 &= \langle (a \Phi(f) - \Phi(f) a)\alpha, \beta\rangle\\
      &= \langle \Phi(f) \alpha, a^*\beta\rangle - \langle \Phi(f) (a\alpha), \beta\rangle\\
      &= \int_X f\, dE_{\alpha, a^* \beta} - \int_X f\, dE_{a\alpha, \beta},
    \end{align*}
    so by uniqueness from Riesz--Markoff, we get $E_{\alpha, a^* \beta} = E_{a\alpha,\beta}$.
    Reversing this calculation shows that $a$ commutes with all $\Phi(g) = \int_X g\, dE$ for $g \in B(X)$, so 
    $\Phi(B(X)) \subseteq \Phi(C(X))''$. \qedhere
  \end{enumerate}
\end{myproof}

\begin{remark}
  The map $\Phi$ is not necessarily isometric.
  However, it induces an isometric $*$-isomorphism $\widetilde{\Phi}: L^\infty (X, \mu) \to \bh$.
\end{remark}

Recall that for an abelian $C^*$-algebra $A$, the Gelfand transform 
$$\Gamma: A \to {C} (\sigma(A))$$
is an isometric $*$-isomorphism.

\begin{theorem}[Spectral theorem]\label{thm:6.1}
  Let $A \subseteq \bh$ be an abelian $C^*$-algebra, and let
  $\mathcal{B}_{\sigma(A)}$ be the Borel $\sigma$-algebra on $\sigma(A)$.
  Then, there exists a PVM $E$ for $(\sigma(A), \mathcal{B}_{\sigma(A)}, \mathcal{H})$ such that 
  $$x = \int_{\sigma(A)} \Gamma (x)\, dE$$
  for all $x \in A$.
\end{theorem}


\begin{myproof}
  For all $\alpha, \beta \in \mathcal{H}$, define
  $$\varphi: C(\sigma(A)) \to \C,\quad f \mapsto \langle \Gamma^{-1} (f) \alpha, \beta\rangle.$$
  This is a bounded linear functional. Indeed, since $\Gamma$ is an isometry, we get
  $$\langle \Gamma^{-1} (f) \alpha, \beta\rangle \leq \| f\|_{\infty} \|\alpha\| \|\beta\|.$$
  By the Riesz--Markoff theorem, there exists a unique regular Borel measure $\mu_{\alpha, \beta}$ such that
  $$\langle \Gamma^{-1} (f) \alpha, \beta\rangle = \int_{\sigma(A)} f\, d\mu_{\alpha, \beta}.$$
  We will show that $\mu_{\alpha, \beta} = E_{\alpha, \beta}$ for a PVM $E$.
  For $f, g \in C(\sigma(A))$, we have 
  $$\int_{\sigma(A)} fg\, d\mu_{\alpha, \beta} = \langle \Gamma^{-1}(fg) \alpha, \beta\rangle = \langle \Gamma^{-1} (f) \Gamma(g) \alpha, \beta \rangle = \int_{\sigma(A)} f\, d\mu_{\Gamma^{-1} (g) \alpha, \beta}.$$
  This is also equal to 
  $$\langle \Gamma^{-1} (f) \alpha, \Gamma^{-1} (\overline{g}) \beta \rangle = \int_{\sigma(A)} f\, d\mu_{\alpha, \Gamma^{-1} (\overline{g}) \beta}.$$
  By the uniqueness in Riesz--Markoff, we obtain 
  $$g\, d{\mu_{\alpha, \beta}} = d\mu_{\Gamma^{-1} (g) \alpha, \beta} = d\mu_{\alpha, \Gamma^{-1}(\overline{g})\beta}.$$
  Finally, we have
  \begin{align*}
    \int_{\sigma(A)} f \, d\overline{\mu_{\alpha, \beta}} &= \overline{\int \overline{f}\, d\mu_{\alpha, \beta}}\\
    &= \overline{\langle \Gamma^{-1} (\overline{f}) \alpha, \beta \rangle}\\
    &= \overline{\langle \alpha, \Gamma^{-1} (f) \beta \rangle}\\
    &= \langle \Gamma^{-1} (f) \beta, \alpha\rangle\\
    &= \int_{\sigma(A)} f\, d\mu_{\beta, \alpha}
  \end{align*}
  for all $f \in C(\sigma(A))$, which implies $\overline{\mu_{\alpha, \beta}} = \mu_{\beta, \alpha}$. 
  To each $S \in \mathcal{B}_{\sigma(A)}$, we assign the sesquilinear form 
  $$\mathcal{H} \times \mathcal{H} \to \C,\quad (\alpha, \beta) \mapsto \int_{\sigma(A)} \chi_S \, d\mu_{\alpha, \beta}.$$
  This form is bounded by $\|\alpha\| \|\beta\| = \|\mu_{\alpha, \beta}\|$.
  Thus, there exists $E(S) \in \bh$ such that 
  $$\int_{\sigma(A)}\chi_S \, d\mu_{\alpha, \beta} = \langle E(S) \alpha, \beta\rangle.$$
  Now notice that 
  \begin{align*}
    \langle E(S)^* \alpha, \beta \rangle &= \langle \alpha, E(S) \beta\rangle\\
    &= \overline{\langle E(S) \beta, \alpha \rangle}\\
    &= \overline{\int_{\sigma(A)} \chi_S\, d\mu_{\beta, \alpha}}\\
    &= \int_{\sigma(A)} \chi_S\, d\overline{\mu_{\beta, \alpha}}\\
    &= \int_{\sigma(A)} \chi_S d\mu_{\alpha, \beta}\\
    &= \langle E(S) \alpha, \beta\rangle,
  \end{align*}
  so $E(S) = E(S)^*$.
  We now show that $E$ is a projection-valued measure. Using the weak-$*$ density of $C(\sigma(A))$ in $B(\sigma(A))$, we obtain
  $$E(S)E(T) = E(S \cap T).$$
  This shows that $E(S)$ is a projection.
  Further, 
  $$E(\sigma(A)) = 1,$$
  and since $\mu_{\alpha, \beta}$ is $\sigma$-additive, we conclude that
  $$E\left(\bigcup_{i = 1} ^\infty S_i\right) = \sum_{i = 1}^\infty E(S_i)$$
  for pairwise disjoint sets $(S_i)_i$. This proves that $E$ is a PVM.
  Finally, for all $\alpha, \beta \in \mathcal{H}$, we get 
  $$E_{\alpha, \beta} (S) = \langle E(S)\alpha, \beta\rangle = \mu_{\alpha, \beta} (S),$$
  so $\mu_{\alpha, \beta} = E_{\alpha, \beta}$, and
  $$\int f\, dE_{\alpha, \beta} = \langle \Gamma^{-1} (f) \alpha, \beta\rangle.$$
  This proves that 
  $$x = \int_{\sigma(A)} \Gamma(x)\, dE \quad \forall x \in A.$$
  Uniqueness: Suppose $E'$ is another such PVM. Then, for all $f \in C(\sigma(A))$,
  $$\int_{\sigma(A)} f\, dE_{\alpha, \beta} = \langle \Gamma^{-1} (f)\alpha, \beta\rangle = \int_{\sigma(A)} f\, dE_{\alpha, \beta}'.$$
  Thus, $E_{\alpha, \beta} = E_{\alpha, \beta} '$ in $C(\sigma(A))^*$, which implies $E = E'$.
\end{myproof}

\begin{lemma}[Goldstine's theorem]
  Let $X$ be a Banach space. Then the image of 
  $$\iota: X \to X^{**},\quad x \mapsto (f \mapsto f(x))$$
  is dense in the weak-$*$ topology.
\end{lemma}

\begin{myproof}
  Let $\beta \in X^{**}$ and $f_1, \dots, f_r \in X^*$ (w.l.o.g. linearly independent).
  The set
  $$U = \{\alpha \in X^{**}\ |\ |(\alpha - \beta) (f_j)| < \varepsilon,\ j = 1, \dots, r\}$$
  is a basic weak-$*$ open set in $X^{**}$.
  Assume $X$ is infinite-dimensional. Consider the surjective linear map 
  $$\Phi: X \to \C^r,\quad x \mapsto (f_1 (x),\dots, f_r (x)).$$
  Then, there exists $x_0 \in X$ such that 
  $$\Phi(x_0) = (\beta(f_1), \dots, \beta(f_r)),$$
  hence $\iota (x_0) \in U \cap \iota (X)$.
\end{myproof}

\subsection{Borel functional calculus}

Let $x \in \bh$ be normal and $A := C^* (x) \subseteq \mathcal{B}(\mathcal{H})$ an abelian $C^*$-algebra, generated by $x$.
By the spectral theorem, there exists a PVM $E$ for $(\sigma(A), \mathcal{B}_{\sigma(A)}, \mathcal{H})$ 
and 
$$\Phi: B (\sigma(A)) \to \bh,\quad f \mapsto \int_{\sigma(A)} f\, dE$$
is a $*$-homomorphism and a contraction by proposition \ref{prop:6.1}
Since $\sigma(x) = \sigma_{C^* (x)}$, we have the homeomorphism $\tau: \sigma(C^* (x)) \to \sigma(x)$, which induces
the isometric $*$-isomorphism 
$$\tau^{\#}: B(\sigma(x)) \to B(C^* (x)),\quad f \mapsto f \circ \tau.$$
We can now define a map 
$$\rho = \Phi \circ \tau^{\#}: B(\sigma(x)) \to \bh,$$
called the \emph{Borel functional calculus}. 
\[\begin{tikzcd}
	{\bh} && {C(\sigma(A))} \\
	& {C(\sigma(x))}
	\arrow["{\tau^{\#}}"', from=2-2, to=1-3]
	\arrow["\rho", from=2-2, to=1-1]
	\arrow["\Phi", from=1-3, to=1-1]
\end{tikzcd}\]
As with the continuous functional calculus, we will employ the notation $f(x) := \rho(f)$.
This notation makes sense because the Borel functional calculus actually extends the continuous functional calculus.
Indeed, for $f \in C(\sigma(x))$, we have
$$\rho (f) = \int_{\sigma(x)} f\, dE = \int_{\sigma(A)} \tau^{\#}(f)\, dE = \Gamma^{-1} (\tau^{\#}(f)) = (\Gamma^{-1} \circ \tau^{\#})(f),$$
which implies that $\rho$, when restricted to $C(\sigma(x))$, coincides with the continuous functional calculus.
As a corollary, if $f = \id \in B(\sigma(x))$, then 
$$\rho (\id) = \int_{\sigma (x)} \id \, dE = x.$$
Since $\rho$ extends continuous functional calculus, we have by the second item of proposition \ref{prop:6.1}
$$\rho (B(\sigma(x))) = \Phi (B(\sigma(A))) \subseteq \Phi (C(\sigma(A)))'' = \rho (C(\sigma(x)))'' = A''.$$
By the Bicommutant theorem, we have $A'' = W^*(x)$, where $W^* (x)$ is the vNa, generated by $x$.

\begin{theorem}[Spectral mapping theorem]
  Let $A \subseteq \bh$ be a vNa and let $x \in A$ be normal.
  Then the Borel functional calculus has the following properties:
  \begin{enumerate}
    \item The map $$B (\sigma(x)) \to W^*(x),\quad f \mapsto f(x)$$
    is a contractive $*$-homomorphism.
    \item If $f \in C(\sigma(x))$, then this $f(x)$ coincides with the $f(x)$ from the continuous functional calculus.
    \item For $f \in B (\sigma(x))$, we have $\sigma(f(x)) \subseteq f(\sigma(x))$.
  \end{enumerate}
\end{theorem}

\begin{myproof}
  The first and second item follow directly from the above discussion. 
  Let us prove the third item.
  Suppose $\lambda \notin f(\sigma (x))$. Then $f - \lambda \in \mathcal{B} (\sigma(x))$
    is invertible in $\mathcal{B}(\sigma(x))$, so there exists $g \in \mathcal{B} (\sigma(x))$ such that $(f - \lambda) g = \id$.
    By the Borel functional calculus, $(f(x) - \lambda I) \cdot g(x) = I$, so $\lambda \notin \sigma(f(x))$. 
\end{myproof}

The spectral theorem is a powerful result that enables us to answer many questions about normal operators.
Let us mention some of its consequences.

\begin{corollary}
  Every vNa is the norm-closure of the linear span of its projections.
\end{corollary}

\begin{myproof}
  Let $M \subseteq \bh$ be a vNa and $x \in M$. Using that $\real x, \imag x \in M_{\sa}$,
  we may assume without loss of generality that $x \in M_{\sa}$. Hence $x$ is normal, and for all $f \in B(\sigma(x))$, we have $f(x) \in M$.
  For $S \in \mathcal{B}_{\sigma(x)}$, the characteristic function $\chi_S (x) \in M$ is a projection. 
  Now we can uniformly approximate $\id$ on $\sigma(x)$ using simple functions. By the Borel functional calculus, 
  $x$ is uniformly approximated by linear combinations of projections.
\end{myproof}

\begin{remark}
  There exist $C^*$-algebras without nontrivial projections.
  For example, for a compact Hausdorff connected space $X$, the algebra $C(X)$ only has trivial projections $0$ and $1$.
  There also exist nonabelian examples.            
\end{remark}

We can now prove the statement in example \ref{ex:3.1}. We begin with a lemma.

\begin{lemma}
  If $x \in \bh$ is a normal operator and $x = \int_{\sigma(x)} z\, dE$, then $N$ is compact iff for every $\varepsilon > 0$,
  $E(\{z\ |\ |z| > \varepsilon\})$ has finite rank.
\end{lemma}

\begin{myproof}
  If $\varepsilon > 0$, then define $\Delta_{\varepsilon} := \{z\ |\ |z| > \varepsilon\}$ and $e_\varepsilon := E(\Delta_\varepsilon)$.
  Then 
  \begin{align*}
    x - x e_\varepsilon &= \int_{\sigma(x)} z\, dE - \int_{\sigma(x)} z \chi_{\Delta_\varepsilon} (z)\, dE\\
    &= \int_{\sigma(x)} z \chi_{\C \setminus \Delta_\varepsilon} (z)\, dE = \phi (x),
  \end{align*}
  where $\phi (z) = z \chi_{\C \setminus \Delta_{\varepsilon}}$. 
  Since the Borel functional calculus is a contraction, this implies that $$\| x - x e_\varepsilon\| = \| \phi(x)\| \leq \|\phi\|_\infty \leq \varepsilon.$$
  Therefore, we can approximate $x$ with operators $x e_{\varepsilon}$. If every $e_{\varepsilon}$ has finite rank, then every $x e_\varepsilon$
  has finite rank and $x$ can be approximated using finite rank operators, so it must be compact.
  Conversely, let $x$ be compact and take an arbitrary $\varepsilon > 0$. Define the function $\psi (z) = z^{-1} \chi_{\Delta_\varepsilon}$.
  Then $$x \psi (x) = \int_{\sigma(x)} z z^{-1} \chi_{\Delta_\varepsilon} \, dE = \int_{\sigma(x)} \chi_{\Delta_\varepsilon} = E_\varepsilon$$
  is compact. Define a map $\iota_\varepsilon: {\im e_\varepsilon}\hookrightarrow \mathcal{H}$. Of course, $\im e_{\varepsilon}$ is closed (and therefore Hilbert) in $\mathcal{H}$ 
  since $e_\varepsilon$ is a projection.
  Now $$E_{\varepsilon} \circ \iota_\varepsilon = \id : {\im e_\varepsilon} \to {\im e_\varepsilon}$$
  must be compact, which can happen only if ${\im e_\varepsilon}$ has finite dimension. As a result, $e_\varepsilon$ is a finite rank operator.
\end{myproof}

\begin{corollary}\label{cor:6.1}
  If $\mathcal{H}$ is separable and and $I$ is an ideal of $\bh$ that contains a noncompact operator, then $I = \bh$.
\end{corollary}

\begin{myproof}
  Suppose that $x \in I$ is noncompact and let 
  $$x^* x = \int_{\sigma(x^* x)} z\, dE$$
  by the spectral theorem. By the previous lemma, there exists such an $\varepsilon > 0$ such that 
  $e_{\varepsilon} = E(\varepsilon, \infty)$ has infinite rank. Now notice that 
  $$e_\varepsilon = \int_{\sigma(x)} \chi_{(\varepsilon, \infty)}\, dE = \int_{\sigma(x)} z^{-1} \chi_{(\varepsilon, \infty)} z\, dE = \left(\int_{\sigma(x)} z^{-1} \chi_{(\varepsilon, \infty)}\, dE\right) (x^* x) \in I.$$
  Let $U: \mathcal{H}\to e_{\varepsilon} \mathcal{H}$ be a unitary (such an $U$ exists because $\dim \mathcal{H} = \dim e_\varepsilon \mathcal{H} = |\N|$).
  Then $U^* e_\varepsilon U = \id_{\mathcal{H}} \in I$, hence $I = \bh$.
\end{myproof}

\begin{remark}
  The statement is not true for $\mathcal{H}$ with dimension of higher cardinality. 
  Notice that $\mathcal{K}(\mathcal{H})$ is a closed ideal, generated by the operators of finite rank.
  If $\mathcal{H}$ is not separable, then operators with separable image (or any cardinality less than the dimension of $\mathcal{H}$) 
  also generate a closed proper ideal in $\bh$.
\end{remark}

\subsection{Abelian vNa's}

\begin{definition}
  Let $A \subseteq \mathcal{B}(\mathcal{H})$ be a subalgebra. A vector $\alpha \in \mathcal{H}$ is:
  \begin{enumerate}
    \item \emph{Cyclic} for $A$ if $A \alpha$ is dense in $\mathcal{H}$.
    \item \emph{Separating} for $A$ if $x \alpha = 0$ for $x \in A$ implies $x = 0$.
  \end{enumerate}
\end{definition}

\begin{proposition}
  Let $A \subseteq \bh$ be a subalgebra.
  \begin{enumerate}
    \item If $\alpha \in \mathcal{H}$ is cyclic for $A$, then it is separating for $A'$.
    \item Assume $A$ is a $*$-subalgebra. Then, if $\alpha$ is separating for $A'$, it is cyclic for $A$.
    \item Suppose $W \subseteq \bh$ is a vNa. Then $\alpha$ is cyclic for $M$ iff it is separating for $M'$,
    and separating for $M$ iff it is cyclic for $M'$.
  \end{enumerate}
\end{proposition}

\begin{myproof}
  \begin{enumerate}
    \item Let $\alpha$ be cyclic for $A$. Let $y \in A'$ satisfy $y \alpha = 0$.
    Pick any $\beta \in \mathcal{H}$. There exists a sequence $(x_n)_n \subseteq A$ such that $\|x_n \alpha - \beta\| \to 0$.
    Hence, $$y \beta = \lim_{n \to \infty} yx_n \alpha = \lim_{n \to \infty} x_n (y\alpha) = 0,$$
    and $\alpha$ is separating for $A'$.
    \item Define $\mathcal{K} := (A \alpha)^{\perp} \leq \mathcal{H}$.
    Let $p: \mathcal{H} \to \mathcal{K}$ be the orthogonal projection.
    For $x_1, x_2 \in A$ and $\beta \in \mathcal{K}$, we have 
    $$\langle x_1 \beta, x_2 \alpha\rangle = \langle \beta, x_1 ^* x_2 \alpha \rangle = 0,$$
    so $x_1 \beta \in \mathcal{K}$, and $\mathcal{K}$ is an invariant subspace for $A$.
    But since $A$ is $*$-closed, $\mathcal{K}$ is reducing, and by lemma \ref{lem:5.2}, $p \in A'$.
    Of course, $\alpha \in A \alpha$ and $p\alpha = 0$. Now we use the fact that $\alpha$ is 
    separating for $A'$, and therefore $p = 0$. This implies $\mathcal{K} = (0)$.
    \item This follows immediately from $M = M''$ and the previous two points. \qedhere
  \end{enumerate}
\end{myproof}

\begin{example}
  Recall that $VN (\Gamma) := \lambda (\C [\Gamma])'' \subseteq \mathcal{B} (\ell^2 (\Gamma))$.
  Similarly, we can use the right regular map 
  $$\rho: \Gamma \to \mathcal{B} (\ell^2 (\Gamma)),\quad g \mapsto (\rho_g: \delta_k \mapsto \delta_{kg^{-1}})$$
  to define $VN_{\mathrm{right}} (\Gamma) = \rho(\Gamma)'' \subseteq \mathcal{B} (\ell^2 (\Gamma))$.
  Notice that $\delta_e \in \ell^2 (\Gamma)$ is cyclic for both $\lambda (\C [\Gamma])$ and $\rho(\C[\Gamma])$.
  This means that it is cyclic for both $VN(\Gamma)$ and $VN_{\mathrm{right}} (\Gamma)$.
  It's easy to see that $VN(\Gamma)' = VN_{\mathrm{right}} (\Gamma)$, so $\delta_e$
  is separating for both $VN(\Gamma)$ and $VN_{\mathrm{right}} (\Gamma)$.
\end{example}

\begin{corollary}
  If $A \subseteq \bh$ is abelian, then each cyclic vector for $A$ is also separating for $A$.
\end{corollary}

\begin{myproof}
  If $\alpha \in \mathcal{H}$ is cyclic for $A$, then it is separating for $A'$, 
  but since $A \subseteq A'$, it is also separating for $A$.
\end{myproof}

Recall from example \ref{ex:5.1} that for a $\sigma$-finite measure on $X$, the map 
$$M: L^\infty (X, \mu) \to \mathcal{B} (L^2 (X, \mu))$$
is an isometric $*$-isomorphism onto its image. In the remainder of this chapter, we will identify 
$L^\infty(X, \mu)$ as the image in $\mathcal{B} (L^2 (X, \mu))$.

\begin{theorem}[Classification of abelian vNa's]\label{thm:6.2}
  Let $A \subseteq \mathcal{B}(\mathcal{H})$ be an abelian vNa with a cyclic vector $\alpha_0 \in \mathcal{H}$.
  Suppose $A_0 \subseteq A$ is a $C^*$-algebra that is SOT-dense. Then, there exists a finite regular positive Borel measure 
  $\mu$ on $\sigma(A_0)$ and an isomorphism $$\widetilde{\Gamma}: A \to L^\infty (\sigma (A_0), \mu) \subseteq \mathcal{B} (L^2 (\sigma(A_0), \mu))$$
  that extends the Gelfand transform $\Gamma: A_0 \to C(\sigma(A_0))$.
  Furthermore, $\widetilde{\Gamma}$ is spatial, that is, it is induced by conjugation with a unitary 
  $U: \mathcal{H} \to L^2 (\sigma(A_0), \mu)$.
\end{theorem}

\begin{remark}
  Applying this theorem to $A_0 = A$, we get 
  $$ L^{\infty} (\sigma(A), \mu) = \widetilde{\Gamma} (A) = C(\sigma(A)).$$
\end{remark}

We begin with the following lemma.

\begin{lemma}
  $C(\sigma(A_0))$ is weak-$*$ dense in $L^{\infty} (\sigma(A_0), \mu)$.
\end{lemma}

\begin{myproof}
  For any bounded measurable function $f \in B(\sigma(A_0))$, there exists a net $(f_i)_i \subseteq C(\sigma(A_0))$
  such that $f_i \xrightarrow{\textrm{weak-$*$}} f$ by Goldstine (see the proof of theorem \ref{thm:6.1}).
\end{myproof}
\begin{myproof}
  Since $A_0$ is an abelian $C^*$-algebra, the Gelfand transform $\Gamma: A_0 \to C(\sigma(A_0))$ is an isometric $*$-isomorphism. Define $\varphi_0: A \to \C$ by $x \mapsto \langle x \alpha_0, \alpha_0\rangle$. Then $\varphi_0 \Gamma^{-1} : C(\sigma(A_0)) \to \C$ is a bounded linear functional, so by the Riesz--Markoff theorem, there exists a regular Borel measure $\mu$ on $\sigma(A_0)$ such that
  $$ \varphi_0 \Gamma^{-1} (f) = \int_{\sigma(A_0)} f\, d\mu. $$
  For every positive function $f \in C(\sigma(A_0))$, we have 
  \begin{align*}
    \int_{\sigma(A_0)} f\, d\mu &= \int \sqrt{f}^2\, d\mu = \varphi_0 \Gamma^{-1} (\sqrt{f}^2) = \langle \Gamma^{-1} (\sqrt{f}^2) \alpha_0, \alpha_0 \rangle \\
    &= \langle \Gamma^{-1} (\sqrt{f})^2 \alpha_0, \alpha_0 \rangle = \langle \Gamma^{-1} (\sqrt{f}) \alpha_0, \Gamma^{-1} (\sqrt{f}) \alpha_0 \rangle \\
    &= \| \Gamma^{-1} (\sqrt{f}) \alpha_0 \|^2 \geq 0
  \end{align*}
  and $\mu$ is a positive measure. Furthermore, $\mu$ is finite, since 
  $$ \mu(\sigma(A_0)) = \varphi_0 (1) = \|\alpha_0\|^2 < \infty. $$
  Now we prove that $\mathrm{supp}\, \mu = \sigma(A_0)$. If $\mathrm{supp}\, \mu \subsetneqq \sigma(A_0)$, then there exists a non-empty open set $S \subseteq \sigma(A_0)$ with $\mu(S) = 0$. Consider a nonnegative function $f \in C(\sigma(A_0)) \setminus \{0\}$ with $f\big|_{\sigma(A_0) \setminus S} = 0$. Then 
  $$ \| \Gamma^{-1} (\sqrt{f}) \alpha_0 \|^2 = \int_{\sigma(A_0)} f\, d\mu = \int_S f\, d\mu = 0. $$
  We get $\Gamma^{-1} (\sqrt{f}) \alpha_0 = 0$, which, by the cyclicity of $\alpha_0$, implies $\Gamma^{-1} (\sqrt{f}) = 0$, $\sqrt{f} = 0$, and $f = 0$, a contradiction. 
  Define 
  $$ U_0 : A_0 \alpha_0 \to C(\sigma(A_0)) \subseteq L^2 (\sigma(A_0), \mu), \quad x \alpha_0 \mapsto \Gamma(x). $$
  Since $\alpha_0$ is separating for $A_0$, this $U_0$ is a well-defined linear map. For $x, y \in A_0$, we have 
  \begin{align*}
    \langle U_0 (x \alpha_0), U_0 (y \alpha_0) \rangle &= \langle \Gamma(x), \Gamma(y)\rangle_2 \\
    &= \int_{\sigma (A_0)}  \overline{\Gamma(y)} \Gamma(x)\, d\mu \\
    &= \int_{\sigma (A_0)} \Gamma(y^* x)\, d\mu \\
    &= \varphi(y^* x) = \langle y^* x \alpha_0, \alpha_0 \rangle = \langle x \alpha_0, y \alpha_0\rangle
  \end{align*}
  and so $U_0$ is an isometry! Since $\alpha_0$ is cyclic for $A$ and $A_0$ is SOT-dense in $A$, $\alpha_0$ is cyclic for $A_0$. Thus, $A_0 \alpha_0$ is dense in $\mathcal{H}$ and the image of $U_0$ is the entire $C(\sigma(A_0))$. By continuity, $U_0$ extends to a surjective isometry 
  $$ U : \mathcal{H} \to L^2 (\sigma(A_0), \mu) = \overline{C(\sigma(A_0), \mu)}^{\langle \cdot, \cdot \rangle_2}, $$
  where $U$ is unitary. Next, define 
  $$ \widetilde{\Gamma} : A \to \mathcal{B} (L^2 (\sigma(A_0), \mu)), \quad x \mapsto UxU^*. $$
  We claim that $\widetilde{\Gamma}$ is an isometric $*$-homomorphism. Since $U$ is unitary, the isometric part is obvious, and the homomorphism property soon follows.
  Now we claim that $\widetilde{\Gamma} (A) = L^\infty (\sigma(A_0), \mu)$. For $x \in A_0$ and $g \in C(\sigma(A_0))$, we have 
  \begin{align*}
    \widetilde{\Gamma} (x) g &= UxU^* g = U x U^{-1} (\Gamma (\Gamma^{-1} (g))) \\
    &= U x (\Gamma^{-1} (g)\alpha_0)= \Gamma (x \Gamma^{-1} (g)) \\ 
    &= \Gamma(x) g 
  \end{align*}
  and since $C(\sigma (A_0))$ is dense in $L^2 (\sigma(A_0), \mu)$, we get $\widetilde{\Gamma}(x) = M_{\Gamma(x)}$. It follows that 
  $$ \widetilde{\Gamma} (A_0) = C(\sigma (A_0)) \subseteq L^\infty (\sigma(A_0), \mu). $$
  Then we use the fact that $\widetilde{\Gamma}$ is SOT-continuous (by definition) and that $L^\infty$ is a vNa to get
  $$ \widetilde{\Gamma} (A) = \widetilde{\Gamma} (\overline{A_0}^{\mathrm{SOT}}) \subseteq \overline{\widetilde{\Gamma} (A_0)}^{\mathrm{SOT}} \subseteq \overline{L^\infty (\sigma(A_0), \mu)}^{\mathrm{SOT}} = L^\infty (\sigma(A_0), \mu). $$
  The reverse inclusion is proved by nets. Suppose $(\widetilde{\Gamma} (x_i))_i \subseteq \widetilde{\Gamma} (A_0)$ WOT-converges to $T \in B(L^2 (\sigma(A_0), \mu))$. Then for all $\beta \mu \in \mathcal{H}$ we have 
  \begin{align*}
    \langle TU \beta, U\mu\rangle &= \lim_{i} \langle \widetilde{\Gamma} (x_i) U\beta, U\mu\rangle \\
    &= \lim_i \langle Ux_i U^* U \beta, U\mu \rangle \\
    &= \lim_i \langle x_i \beta, \mu \rangle
  \end{align*} 
  and $(x_i)_i \xrightarrow{\mathrm{WOT}} U^* T U \in \mathcal{B}(\mathcal{H})$. Since $\overline{A_0}^{\mathrm{WOT}} = A$, we get $x = U^* T U \in A$ and $\widetilde{\Gamma}(x) = T$, so $\overline{\widetilde{\Gamma} (A_0)}^{\mathrm{WOT}} \subseteq \widetilde{\Gamma} (A)$.
  Finally, we ask: what is $\overline{C(\sigma(A_0))}^{\mathrm{WOT}}$? The WOT on that set is generated by seminorms 
  $$ |\langle M_g \alpha, \beta \rangle| = \left| \int_{\sigma(A_0)} g \alpha \beta\, d\mu \right|, $$
  where $g \in C(\sigma(A_0))$ and $\alpha, \beta \in L^2 (\sigma(A_0), \mu)$. By theorem \ref{thm:6.3}, the weak-$*$ topology on $L^\infty (\sigma(A_0), \mu)$ is generated by seminorms 
  $$ \left| \int_{\sigma(A_0)} g \gamma\, d\mu \right|, $$
  where $\mu \in L^1 (\sigma(A_0), \mu)$. By Hölder's inequality, an $L^1$ function is a product of two $L^2$ functions, so these two topologies coincide.
  By the lemma above, $C(\sigma(A_0))$ is weak-$*$ dense in $L^\infty (\sigma(A_0), \mu)$. Therefore, we have 
  $$ L^\infty (\sigma(A_0), \mu) = \overline{C(\sigma(A_0))}^{\mathrm{WOT}} = \overline{\widetilde{\Gamma} (A_0)}^{\mathrm{WOT}} \subseteq \widetilde{\Gamma} (A) $$
  and finally $\widetilde{\Gamma} (A) = L^\infty (\sigma(A_0), \mu)$.
\end{myproof}

In the proof, we used the well known theorem from measure theory (theorem 6.16 in \cite{rudin}).

\begin{theorem}\label{thm:6.3}
  Suppose $1 \leq p < \infty$ and $\mu$ is a $\sigma$-finite positive measure on $X$,
  and $\Phi$ is a bounded linear functional on $L^p(X, \mu)$.
  Then there is a unique $g \in L^q(X, \mu)$, where $\frac{1}{p} + \frac{1}{q} = 1$, such that 
  $$\Phi(f) = \int_X f g\, d\mu.$$ Moreover, $\|\Phi\| = \|g\|_q$.
\end{theorem}

How crucial is the cyclicity assumption?
Let $A \subseteq \mathcal{B}(\mathcal{H})$ be an abelian vNa. Pick $0 \neq \alpha \in \mathcal{H}$.
Define $\mathcal{K} := \overline{A \alpha}$ and let $p: \mathcal{H} \to \mathcal{K}$ be an orthogonal 
projection. By the reducibility of $\mathcal{K}$, we get $p \in A'$. Therefore, $p A p = A p \subseteq \mathcal{B}(\mathcal{H})$
is an abelian vNa with a cyclic vector $\alpha \in \mathcal{K}$.
Then, again by the theorem, $A p \cong L^\infty(X, \mu)$ for some $(X, \mu)$.
By Zorn's lemma, $A \cong L^\infty(Y, \nu)$ for some disjoint union of measure spaces $(Y, \nu)$.

\begin{proposition}\label{prop:6.2}
  Let $\mathcal{H}$ be a separable Hilbert space and $A \subseteq \mathcal{B}(\mathcal{H})$
  be an abelian vNa. Then there exists a separating vector for $A$.
\end{proposition}

\begin{myproof}
  By Zorn's lemma, there exists a maximal set of unit vectors $(\alpha_k)_k$ such that $A \alpha_k \perp A \alpha_l$
  for $k \neq l$. By maximality, $\sum_k A \alpha_k$ is dense in $\mathcal{H}$.
  Define $\alpha = \sum_{n = 1}^\infty \frac{1}{2^n} \alpha_n$. We claim that $\alpha$ is separating for $A$.
  Indeed, let $x \in A$ such that $x \alpha = 0$. Then $\sum_{n = 1}^\infty \frac{1}{2^n} x \alpha_n = 0$.
  By orthogonality, $x \alpha_n = 0$ for all indices $n$. For all $y \in A$, we get 
  $x y \alpha_n = y x \alpha_n = 0$, so $x\big|_{A \alpha_n} = 0$ for all $n$. But since $\sum_n A \alpha_n$ is dense in $A$, we get $x = 0$.
\end{myproof}

\begin{corollary}
  Let $\mathcal{H}$ be a separable Hilbert space and $A \subseteq \mathcal{B}(\mathcal{H})$
  be a maximal abelian vNa. Then there exists a cyclic vector for $A$.
\end{corollary}

\begin{myproof}
  By proposition \ref{prop:6.2}, there exists a separating vector $\alpha$ for $A$, which is then cyclic for 
  $A'$. But since $A$ is maximal, we get $A = A'$.
\end{myproof}

\begin{theorem}
  Let $\mathcal{H}$ be a separable Hilbert space and $A \subseteq \mathcal{B}(\mathcal{H})$ an abelian 
  vNa. Then there exists a compact Hausdorff space $X$ and a finite regular Borel measure $\mu$ on $X$ such that $A \cong L^\infty(X, \mu)$.
\end{theorem}

\begin{myproof}
  By proposition \ref{prop:6.2}, there exists a separating vector $\alpha \in \mathcal{H}$ for $A$. 
  Form $\mathcal{K} := \overline{A \alpha}$. Then the algebra $\{x\big|_{\mathcal{K}} \mid x \in A\} \subseteq \mathcal{B}(\mathcal{K})$
  is $*$-isomorphic to $A$, has cyclic vector $\alpha$, and the above theorem applies.
\end{myproof}

We can use theorem \ref{thm:6.2} to find $VN(G)$ of an abelian group $G$.
Recall that by definition, $C_r ^* (G)$ is a SOT-dense $C^*$-subalgebra in $VN(G)$.
Moreover, $VN(G)$ has a cyclic vector $\delta_0 \in \ell^2 (G)$.
Therefore, there exists a positive Borel measure $\mu$ on $\sigma_r ^* (G)$ such that $$VN(G) \cong L^\infty (\sigma (C_r ^* (G)), \mu) \cong L^\infty (\widehat{G}, \mu).$$

\begin{example}
  Let us find $VN(\quot{\Z}{n\Z})$.
  Following the proof of theorem \ref{thm:6.2}, all we need to do is find a positive Borel measure $\mu$ on $\quot{\Z}{n\Z}$, such that for any $x \in C_r ^* (G)$, we have
  $$\langle x \delta_0, \delta_0 \rangle = \int_{\quot{\mathbb{Z}}{n\mathbb{Z}}} \Gamma (x)\, d\mu.$$
  Now if $x = \sum_{l = 0} ^{n - 1} a_l u_l$, the LHS of this equation equals $a_0$.
  On the other hand, example \ref{ex:3.2} tells us that the RHS is equal to 
  \begin{align*}
    \sum_{k = 0} ^{n - 1} \mu (\{k\}) \cdot \left(\sum_{l = 0} ^{n - 1} a_l e^{\frac{2 \pi i k l}{n}}\right) = \sum_{l = 0} ^{n - 1} a_l \cdot \left(\sum_{k = 0} ^{n - 1} \mu (\{k\})  e^{\frac{2 \pi i k l}{n}}\right).
  \end{align*}
  The above expression equals $a_0$ if we set $\mu (\{k\}) = \frac{1}{n}$ for any $k \in \quot{\Z}{n\Z}$.
  Therefore, we can take $\mu$ to be the normalized counting measure on $\quot{\Z}{n\Z}$ and 
  $$VN(\quot{\Z}{n\Z}) \cong L^\infty (\quot{\Z}{n\Z}, \mu)$$
  as a $C^*$-algebra. In particular, $VN(\quot{\Z}{n\Z}) \cong C(\quot{\Z}{n\Z}),$
  so we have $VN(\quot{\Z}{n\Z}) = C_r ^* (\quot{\Z}{n\Z})$ and $VN(\quot{\Z}{n\Z})$ is generated by 
  $$u_1 = \begin{pmatrix}
    0 &  & & 1\\
    1 & \ddots && \\
      & \ddots & \ddots & \\
     & & 1 & 0
  \end{pmatrix} \in \ell^2 (\quot{\Z}{n\Z}).$$
\end{example}

\begin{example} 
  Similar to the previous example, we can find $VN(\Z)$.
  Again, it suffices to find a positive Borel measure $\mu$ on $\mathbb{T}$ such that 
  $$\langle x \delta_0, \delta_0 \rangle = \int_{\mathbb{T}} \Gamma (x)\, d\mu$$
  for any $x = \sum_{l \in \Z} a_l u_l \in C_r ^* (\Z)$. Now the LHS of the above equation equals $a_0$,
  while the RHS is equal, by example \ref{ex:3.3}, to 
  $$\int_{\mathbb{T}} \sum_{l \in \Z} a_l \xi^l\, d\mu = \sum_{l \in \Z} \int_{\mathbb{T}} a_l \xi^l \, d\mu$$
  (here, we used Lebesgue's dominated convergence theorem).
  If we set $\mu$ to be the normalized Lebesgue measure $m$ on $\mathbb{T}$, then the above sum equals $a_0$.
  Therefore, we have 
  $$VN(\Z) \cong L^\infty (\mathbb{T}, m)$$
  as a $C^*$-algebra by theorem \ref{thm:6.2}.
\end{example}

